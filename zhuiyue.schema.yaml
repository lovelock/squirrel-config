# Rime schema
# encoding: utf-8

schema:
  schema_id: zhuiyue
  name: æµæ˜Ÿè¿½æœˆ
  version: "0.4.0"
  author:
    - æµæ˜Ÿè¿½æœˆ <zhuangzhemin@qq.com>
  description: |
    æµæ˜Ÿè¿½æœˆ
    - å°é¹¤éŸ³å½¢ æ¥è‡ª å°é¹¤ & å¼€æºå°é¹¤
    - ä¸­æ–‡è¯åº“ æ¥è‡ª ç°ä»£æ±‰è¯­è¯å…¸ & æ¸…åå¼€æºè¯åº“ & ç»´åŸºä¸­æ–‡è¯æ¡
    - è‹±æ–‡è¯åº“åŠä¸­æ–‡é‡Šä¹‰ æ¥è‡ª ç®€æ˜è‹±æ±‰è¯å…¸ï¼ˆå¢å¼ºç‰ˆï¼‰https://github.com/skywind3000/ECDICT
  dependencies:
    - flypy_chars     # å°é¹¤éŸ³å½¢ - å•å­—
    - flypy_phrases   # ä¸­æ–‡è¯åº“ - ç°ä»£æ±‰è¯­è¯å…¸ & æ¸…åå¼€æºè¯åº“
    - ecdict          # è‹±æ–‡å•è¯&è¯ç»„ - ç®€æ˜è‹±æ±‰è¯å…¸ï¼ˆå¢å¼ºç‰ˆï¼‰
    - ecdict_reverse  # ä¸­æ–‡é‡Šä¹‰åæŸ¥ - ç®€æ˜è‹±æ±‰è¯å…¸ï¼ˆå¢å¼ºç‰ˆï¼‰

switches:
  - name: ascii_mode
    states: [ ä¸­, A ]
    reset: 0
  - name: ascii_punct # ä¸­è‹±æ ‡ç‚¹
    states: [ Â¥, $ ]
    reset: 0
  - name: traditionalization
    states: [ ç®€, ç¹ ]
    reset: 0
  - name: emoji
    states: [ ğŸ’€, ğŸ˜„ ]
    reset: 1
  - name: full_shape
    states: [ åŠè§’, å…¨è§’ ]
    reset: 0

engine:
  processors:
    - lua_processor@ecdict_processor               # éASCIIæ¨¡å¼ä¸‹ï¼Œä½¿ç”¨å³shifté”®åˆ‡æ¢ä¸­è‹±/è‹±æ–‡æ¨¡å¼
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - punct_translator
    - script_translator
    - table_translator@flypy_phrases
    - table_translator@custom_phrase_completion
    - table_translator@custom_phrase_no_completion
    - reverse_lookup_translator
    # - table_translator@ecdict
    - lua_translator@date_translator      # æ—¶é—´ã€æ—¥æœŸã€æ˜ŸæœŸ
    # - table_translator@melt_eng           # è‹±æ–‡è¾“å…¥
    - lua_translator@unicode              # Unicode
  filters:
    - simplifier@emoji                  # Emoji
    - simplifier@traditionalize         # ç®€ç¹åˆ‡æ¢
    - lua_filter@reduce_english_filter  # é™ä½éƒ¨åˆ†è‹±è¯­å•è¯åœ¨å€™é€‰é¡¹çš„ä½ç½®
    - reverse_lookup_filter@ecdict_reverse_lookup  # åæŸ¥è‹±æ–‡å•è¯/è¯ç»„çš„ä¸­æ–‡é‡Šä¹‰ï¼Œä½œä¸ºcommentæ˜¾ç¤º
    - lua_filter@ecdict_filter                     # æ§åˆ¶ä¸­è‹±æ··åˆè¾“å…¥æˆ–è€…çº¯è‹±æ–‡è¾“å…¥ï¼Œä»¥åŠæˆªæ–­è¿‡é•¿çš„comment
    - simplifier
    - uniquifier

speller:
  alphabet: "zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA`"
  delimiter: " '"
  algebra:
    # - derive/^(.*)$/~$1/  # æŠŠ*.dict.yamlè¯åº“é‡Œé¢çš„(å…¨æ‹¼)ç¼–ç å¤‡ä»½ä¸€ä»½ï¼Œå¼€å¤´æ·»åŠ â€œ~â€æ ‡è¯†
    - xform/^sh(\w+)$/U$1/
    - xform/^ch(\w+)/I$1/
    - xform/^zh(\w+)/V$1/
    - xform/^(\w+)iang$/$1L/
    - xform/^(\w+)uang$/$1L/
    - xform/^(\w+)iong$/$1S/
    - xform/^(\w+)ong$/$1S/
    - xform/^(\w+)uan$/$1R/
    - xform/^(\w+)eng$/$1G/
    - xform/^(\w+)ang$/$1H/
    - xform/^(\w+)ing$/$1K/
    - xform/^(\w+)uai$/$1K/
    - xform/^(\w+)ian$/$1M/
    - xform/^(\w+)iao$/$1N/
    - xform/^(\w+)iu$/$1Q/
    - xform/^(\w+)ei$/$1W/
    - xform/^(\w+)ue$/$1T/
    - xform/^(\w+)ve$/$1T/
    - xform/^(\w+)un$/$1Y/
    - xform/^(\w+)uo$/$1O/
    - xform/^(\w+)ie$/$1P/
    - xform/^(\w+)ai$/$1D
    - xform/^(\w+)en$/$1F/
    - xform/^(\w+)an$/$1J/
    - xform/^(\w+)ou$/$1Z/
    - xform/^(\w+)ia$/$1X/
    - xform/^(\w+)ua$/$1X/
    - xform/^(\w+)ao$/$1C/
    - xform/^(\w+)ui$/$1V/
    - xform/^(\w+)in$/$1B/
    - xform/^ang$/ah/
    - xform/^eng$/eh/
    - xform/^([aoe])$/$1$1/
    - xlit/QWRTYUIOPSDFGHJKLZXCVBNM/qwrtyuiopsdfghjklzxcvbnm/
    - derive/^(\w+);(\w)(\w)$/$1$2$3/  # Flypy: ABCD
    - derive/^(\w+);(\w)(\w)$/$1$2`/   # Flypy: ABC`
    - derive/^(\w+);(\w)(\w)$/$1`$3/   # Flypy: AB`D
    - derive/^(\w+);(\w)(\w)$/$1``/    # Flypy: AB``
    - derive/^(\w+);(\w)(\w)$/$1$2/    # Flypy: ABC
    - xform/^(\w+);(\w)(\w)$/$1/       # Flypy: AB
    # - xform/^~//                   # æŠŠâ€œ~â€å¼€å¤´çš„åŸå§‹(å…¨æ‹¼)ç¼–ç è¿˜åŸå›æ¥
    #- abbrev/^(.).+$/$1/


# Lua é…ç½®: æ—¥æœŸã€æ—¶é—´ã€æ˜ŸæœŸã€ISO 8601ã€æ—¶é—´æˆ³çš„è§¦å‘å…³é”®å­—
date_translator:
  date: date            # æ—¥æœŸï¼š 2022-11-29
  time: time            # æ—¶é—´ï¼š 18:13
  week: week            # æ˜ŸæœŸï¼š æ˜ŸæœŸäºŒ
  datetime: datetime    # ISO 8601ï¼š 2022-11-29T18:13:11+08:00
  timestamp: timestamp  # æ—¶é—´æˆ³ï¼š 1669716794


# Lua é…ç½®: é™ä½éƒ¨åˆ†è‹±è¯­å•è¯åœ¨å€™é€‰é¡¹çš„ä½ç½®
# è¯¦ç»†ä»‹ç» https://dvel.me/posts/make-rime-en-better/#çŸ­å•è¯ç½®é¡¶çš„é—®é¢˜
# æ­£å¸¸æƒ…å†µï¼š è¾“å…¥ rug å¾—åˆ° ã€Œ1.rug 2.å¦‚æœ â€¦â€¦ ã€
# é™ä½ä¹‹åï¼š è¾“å…¥ rug å¾—åˆ° ã€Œ1.å¦‚æœ 2.rug â€¦â€¦ ã€
reduce_english_filter:
  # é™ä½åˆ°ç¬¬ idx ä¸ªä½ç½®
  idx: 2
  # è¦é™ä½çš„å•è¯ï¼ŒåŒ¹é…çš„æ˜¯è¾“å…¥ç ï¼Œå³å…¨å°å†™ã€‚
  words: [nav, rug, bus, ship, laos, bail, bam, bans, bib, bos, chic, chit, dab, dag, dal, dit, dub, dug, fab, gam, ger, gus, hem, hep, hud, kat, lam, lax, lex, lug, lux, moc, mos, mot, mum, nad, nay, nib, nip, pak, pap, pax, rig, rum, sac, sal, sax, sec, shin, sis, ska, slang, sus, tad, taj, tac, tic, yep, yum, fax, cain, key, mob, buy, dam, wap]


translator:
  dictionary: zhuiyue
  prism: zhuiyue
  enable_correction: false         # ç”µè„‘ä¸Šä¸éœ€è¦å¼€å¯æŒ‰é”®çº é”™
  preedit_format:
  enable_charset_filter: true
  enable_user_dict: false
  spelling_hints: 2
  comment_format:
    - xform/^[^[]+[[]// ## å•å­—ç¼–ç æç¤ºåªæ˜¾ç¤ºè¾…åŠ©ç éƒ¨åˆ†


flypy_phrases:                     # å°é¹¤éŸ³å½¢-çŸ­è¯­ï¼Œæ”¯æŒè‡ªåŠ¨è¡¥å…¨, è¯åº“æºè‡ªç°ä»£æ±‰è¯­è¯å…¸
  enable_encoder: false
  encode_commit_history: false
  enable_sentence: false
  enable_user_dict: true
  dictionary: flypy_phrases
  initial_quality: -1

# æ¬¡ç¿»è¯‘å™¨ï¼Œè‹±æ–‡
melt_eng:
  dictionary: melt_eng     # æŒ‚è½½è¯åº“ melt_eng.dict.yaml
  enable_sentence: false   # ç¦æ­¢é€ å¥
  enable_user_dict: false  # ç¦ç”¨ç”¨æˆ·è¯å…¸
  initial_quality: 1.1     # åˆå§‹æƒé‡
  comment_format:          # è‡ªå®šä¹‰æç¤ºç 
    - xform/.*//           # æ¸…ç©ºæç¤ºç 


# Emoji
emoji:
  opencc_config: emoji.json
  option_name: emoji


# ç®€ç¹åˆ‡æ¢
traditionalize:
  option_name: traditionalization
  opencc_config: s2t.json             # s2t.json | s2hk.json | s2tw.json | s2twp.json
  tips: none                          # è½¬æ¢æç¤º: all éƒ½æ˜¾ç¤º | char ä»…å•å­—æ˜¾ç¤º | none ä¸æ˜¾ç¤ºã€‚
  excluded_types: [ reverse_lookup ]  # ä¸è½¬æ¢åæŸ¥ï¼ˆä¸¤åˆ†æ‹¼å­—ï¼‰çš„å†…å®¹
simplifier:
  opencc_config: t2s.json          # opencc ç¹ä½“->ç®€ä½“è½¬æ¢


ecdict:                           # è‹±æ–‡å•è¯
  enable_encoder: false
  encode_commit_history: false
  enable_sentence: false
  enable_completion: true         # æ˜¯å¦å¯ç”¨è‹±æ–‡è¾“å…¥è”æƒ³è¡¥å…¨
  enable_user_dict: true
  dictionary: ecdict
  initial_quality: 1

ecdict_reverse_lookup:            # æŸ¥è¯¢è‹±æ–‡å•è¯/è¯ç»„çš„ä¸­æ–‡é‡Šä¹‰, ä½œä¸ºCommentè¿›è¡Œæç¤º
  overwrite_comment: true
  dictionary: ECDICT_reverse
  comment_format:
    - xform/\\n/ /
    - xform/^/ /
    # - xform/^(.{1,80}).*$/$1/   # æˆªæ–­è¿‡é•¿çš„commentï¼Œç”¨xformæˆªæ–­ä¸­æ–‡commentæœ€åä¸€ä¸ªå­—ç¬¦å¯èƒ½ä¼šå‡ºç°ä¹±ç , æ”¹æˆç”¨lua_filterå¤„ç†

custom_phrase_completion:         # ç”¨æˆ·è‡ªå®šä¹‰è¯åº“custom_phrase_completion.txtï¼Œæ”¯æŒè‡ªåŠ¨è¡¥å…¨
  dictionary: ""
  user_dict: custom_phrase_completion
  db_class: stabledb
  enable_completion: true
  enable_sentence: false
  initial_quality: 1

custom_phrase_no_completion:     # ç”¨æˆ·è‡ªå®šä¹‰è¯åº“custom_phrase_no_completion.txtï¼Œä¸æ”¯æŒè‡ªåŠ¨è¡¥å…¨
  dictionary: ""
  user_dict: custom_phrase_no_completion
  db_class: stabledb
  enable_completion: false
  enable_sentence: false
  initial_quality: 1

reverse_lookup:
  dictionary: flypy_chars
  enable_completion: true
  prefix: "`"
  suffix: "$"
  tips: ã€”å°é¹¤éŸ³å½¢ã€•

# æ ‡ç‚¹ç¬¦å·
# punctuator ä¸‹é¢æœ‰ä¸‰ä¸ªå­é¡¹ï¼š
#   full_shape å…¨è§’æ ‡ç‚¹æ˜ å°„
#   half_shape åŠè§’æ ‡ç‚¹æ˜ å°„
#   symbols    Rime çš„é¢„è®¾é…ç½®æ˜¯ä»¥ '/' å‰ç¼€å¼€å¤´è¾“å‡ºä¸€ç³»åˆ—å­—ç¬¦ï¼Œè‡ªå®šä¹‰çš„ symbols_v.yaml ä¿®æ”¹æˆäº† 'v' å¼€å¤´ã€‚
punctuator:
  import_preset: default
  full_shape:
    __include: default:/punctuator/full_shape       # ä» default.yaml å¯¼å…¥é…ç½®
  half_shape:
    __include: default:/punctuator/half_shape       # ä» default.yaml å¯¼å…¥é…ç½®
  symbols:
    __include: symbols_caps_v:/symbols              # ä» symbols_caps_v.yaml å¯¼å…¥é…ç½®

# å¤„ç†ç¬¦åˆç‰¹å®šè§„åˆ™çš„è¾“å…¥ç ï¼Œå¦‚ç½‘å€ã€åæŸ¥
recognizer:
  import_preset: default  # ä» default.yaml ç»§æ‰¿é€šç”¨çš„
  patterns:  # å†å¢åŠ æ–¹æ¡ˆä¸“æœ‰çš„ï¼š
    punct: "^v([0-9]|10|[A-Za-z]+)$"  # å“åº” symbols_v.yaml çš„ symbolsï¼Œç”¨ 'v' æ›¿æ¢ '/'
    reverse_lookup: "^u[a-z]+$"       # å“åº”é¹¤å½¢çš„åæŸ¥
    unicode: "^U[a-f0-9]+"            # å“åº” unicode

key_binder:
  bindings:
    # ç”¨"-"å’Œ"="è¿›è¡Œç¿»é¡µ
    - { when: has_menu, accept: minus, send: Page_Up }
    - { when: has_menu, accept: equal, send: Page_Down }
    # ç”¨Tabé”®æ¥ç§»åŠ¨å…‰æ ‡åˆ°ç¬¬2ä¸ªå­—ç¬¦åé¢ï¼Œä»¥ä¾¿è¾“å…¥ç¬¬1ä¸ªå­—çš„å½¢ç 
    - { when: composing, accept: Tab, send_sequence:  "{Home}{Right}{Right}" }
    # Righté”®æ”¹æˆå‘å³ç§»åŠ¨ä¸¤ä¸ªå­—ç¬¦ï¼ˆåŒæ‹¼ä¸¤ä¸ªå­—ç¬¦è¾“å…¥ä¸€ä¸ªæ±‰å­—ï¼‰
    - { when: composing, accept: Right, send_sequence: "{Right}{Right}" } # å‘å³ç§»åŠ¨å…‰æ ‡åˆ°å1ä¸ªå­—ä½ç½®
    # Control+HJKLä½œä¸ºæ–¹å‘é”®
    - { when: has_menu, accept: Control+h, send: Left } # å‘å·¦ç§»åŠ¨å…‰æ ‡åˆ°å‰1ä¸ªå­—ä½ç½®
    - { when: has_menu, accept: Control+j, send: Down } # ç«–æ’å€™é€‰è¯æ¨¡å¼ï¼Œç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå€™é€‰è¯
    - { when: has_menu, accept: Control+k, send: Up } # ç«–æ’å€™é€‰è¯æ¨¡å¼ï¼Œç§»åŠ¨åˆ°ä¸Šä¸€ä¸ªå€™é€‰è¯
    - { when: has_menu, accept: Control+l, send_sequence:  "{Right}" } # å‘å³ç§»åŠ¨å…‰æ ‡åˆ°å1ä¸ªå­—ä½ç½®
    # æ‰‹æœºä¸ŠæŒ‰Shift+Deleteé”®ä¸æ–¹ä¾¿ï¼Œç”¨Xé”®é•¿æŒ‰å¾—åˆ°çš„"Control+x"æ¥åˆ é™¤å€™é€‰å­—
    - { when: has_menu, accept: Control+x, send: Shift+Delete }


menu:
  page_size: 5 #å€™é€‰é¡¹æ•°
  
style:
  horizontal: false       # ä½¿ç”¨ç«–æ’ä»¥é€‚åº”è‹±æ–‡è¾“å…¥ä¸­æ–‡é‡Šä¹‰æ˜¾ç¤ºè¦æ±‚
  # inline_preedit: false   # å¿…é ˆçˆ²false

